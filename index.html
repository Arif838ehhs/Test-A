<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Online Sınaq - Şagird</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
  body { background: #1a0d2b; color: #fff; font-family: Arial; padding: 20px; }
  input, button { padding: 8px; margin: 5px; }
  .hidden { display: none; }
  .question { margin-bottom: 15px; }
</style>
</head>
<body>
<h2>Online Sınaq - Şagird</h2>

<div id="loginDiv">
  <label>Adınız: </label>
  <input type="text" id="studentName" placeholder="Adınızı yazın">
  <button onclick="joinExam()">Qoşul</button>
</div>

<div id="examDiv" class="hidden">
  <div id="timer">Vaxt: 45:00</div>
  <div id="questions"></div>
  <button onclick="finishExam()">Bitdi</button>
</div>

<div id="resultDiv" class="hidden">
  <h3>Nəticəniz:</h3>
  <div id="score"></div>
</div>

<script>
  // TODO: Buraya öz Firebase config-unu əlavə et
  const firebaseConfig = {
  apiKey: "AIzaSyB8pY5faEQs6Xug6o_3aR7wkkQNwG7U1-Q",
  authDomain: "test-a-online.firebaseapp.com",
  databaseURL: "https://test-a-online-default-rtdb.firebaseio.com",
  projectId: "test-a-online",
  storageBucket: "test-a-online.firebasestorage.app",
  messagingSenderId: "2468331357",
  appId: "1:2468331357:web:1aac7674f51b4ec23e32b4"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let studentId = '';
  let examStarted = false;
  let timerInterval;
  let totalTime = 45 * 60; // 45 dəq

  const questions = [
    {q:"İkilik say sisteminin əsas ədədi hansıdır?", a:["8","2","10"], correct:1},
    {q:"Onluq ədəd 5 ikilik sistemdə necə yazılır?", a:["100","101","110"], correct:1},
    {q:"İkilik ədəd 1101 onluq sistemdə neçə edir?", a:["12","13","15"], correct:1},
    {q:"Onaltılıq say sistemində “A” hərfi hansı ədədə bərabərdir?", a:["9","10","11"], correct:1},
    {q:"Onluq ədəd 15 ikilik sistemdə necə yazılır?", a:["1111","1010","1100"], correct:0},
    {q:"2-lik say sistemindən 8-lik sistemə keçmək üçün neçə bit birləşdirilir?", a:["2","3","4"], correct:1},
    {q:"8-lik sistemin əsası hansıdır?", a:["8","10","2"], correct:0},
    {q:"1010₂ = ?₁₆", a:["A","10","B"], correct:0},
    {q:"Onluq ədəd 32 ikilikdə necə yazılır?", a:["10000","100010","100000"], correct:2},
    {q:"Onluq ədəd 8 onaltılıq sistemdə necə yazılır?", a:["8","A","10"], correct:0},
    {q:"1 kilobayt neçə bayta bərabərdir?", a:["100","512","1024"], correct:2},
    {q:"11111111₂ say sistemində bu ədəd onluq sistemdə neçədir?", a:["255","256","254"], correct:0},
    {q:"8-lik ədəd 17₈ onluqda necədir?", a:["15","13","14"], correct:0},
    {q:"16-lıq sistemdə “F” hərfi hansı ədədə bərabərdir?", a:["14","15","16"], correct:1},
    {q:"1011₂ = ?₁₀", a:["10","11","12"], correct:1},
    {q:"2-lik ədəd 10000₂ onluqda neçədir?", a:["16","8","32"], correct:0},
    {q:"8-lik sistemdə ədədin hər bir rəqəmi hansı aralıqdadır?", a:["0–8","1–8","0–7"], correct:2},
    {q:"111₂ × 10₂ = ?₂", a:["1010","1110","1000"], correct:2},
    {q:"101₂ + 11₂ = ?₂", a:["1000","111","110"], correct:1},
    {q:"16-lıq ədəd “1C” onluqda neçədir?", a:["27","28","29"], correct:1},
    {q:"Onluq ədəd 45-i ikilik say sisteminə çevir.", a:["101101"], correct:0},
    {q:"İkilik ədəd 11010₂-nı onluq sistemdə ifadə et.", a:["26"], correct:0},
    {q:"Onaltılıq ədəd 2F₁₆ onluq sistemdə neçə edir?", a:["47"], correct:0},
    {q:"8-lik ədəd 72₈-i ikilik sistemə çevir.", a:["111010"], correct:0},
    {q:"Say sistemləri arasında keçid etməyin əsas prinsiplərini qısa şəkildə izah et.", a:["Hər say sisteminin əsası var (2,8,10,16). Keçid zamanı ədəd əsasa vurulur və cəmlənir."], correct:0}
  ];

  function joinExam(){
    const name = document.getElementById('studentName').value.trim();
    if(!name) return alert("Adınızı yazın!");
    studentId = 's'+Date.now();
    db.ref('students/'+studentId).set({name:name, started:false, answers:[], score:0});
    document.getElementById('loginDiv').classList.add('hidden');
    document.getElementById('examDiv').classList.remove('hidden');

    // Şagird paneli üçün suallar yaradılacaq, amma müəllim başlayana qədər gizlidir
    renderQuestions();
    listenExamStart();
  }

  function renderQuestions(){
    const container = document.getElementById('questions');
    container.innerHTML = '';
    questions.forEach((q,i)=>{
      const div = document.createElement('div');
      div.classList.add('question');
      div.innerHTML = `<b>${i+1}. ${q.q}</b><br>` +
        q.a.map((opt,j)=>`<input type="radio" name="q${i}" value="${j}"> ${opt}<br>`).join('');
      container.appendChild(div);
    });
    container.classList.add('hidden'); // müəllim başlamayanadək gizli
  }

  function listenExamStart(){
    db.ref('examStarted').on('value', snap=>{
      examStarted = snap.val();
      if(examStarted){
        document.getElementById('questions').classList.remove('hidden');
        startTimer();
      }
    });
  }

  function startTimer(){
    timerInterval = setInterval(()=>{
      if(totalTime<=0){
        clearInterval(timerInterval);
        finishExam();
        return;
      }
      totalTime--;
      const min = Math.floor(totalTime/60);
      const sec = totalTime%60;
      document.getElementById('timer').innerText = `Vaxt: ${min}:${sec<10?'0'+sec:sec}`;
    },1000);
  }

  function finishExam(){
    clearInterval(timerInterval);
    const answers=[];
    questions.forEach((q,i)=>{
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      answers.push(selected ? parseInt(selected.value) : -1);
    });
    db.ref('students/'+studentId+'/answers').set(answers);
    calculateScore(answers);
    document.getElementById('examDiv').classList.add('hidden');
    document.getElementById('resultDiv').classList.remove('hidden');
  }

  function calculateScore(answers){
    let score=0;
    questions.forEach((q,i)=>{
      const correct = q.correct;
      if(i<20){ // qapalı suallar
        if(answers[i]===correct) score+=3;
      } else { // açıq suallar
        score+=8; // sadəcə tam bal
      }
    });
    db.ref('students/'+studentId+'/score').set(score);
    document.getElementById('score').innerText = score+" / 100";
  }
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Online Sınaq - Müəllim</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
  body { background: #1a0d2b; color: #fff; font-family: Arial; padding: 20px; }
  button { padding: 8px; margin: 5px; }
  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  th,td { border:1px solid #fff; padding:5px; text-align:center; }
</style>
</head>
<body>
<h2>Online Sınaq - Müəllim</h2>
<button onclick="startExam()">Başla</button>
<button onclick="endExam()">Bitir</button>

<table>
<tr><th>Ad</th><th>Ballar</th><th>Çıxart</th></tr>
<tbody id="studentsTable"></tbody>
</table>

<script>
  const firebaseConfig = {
  apiKey: "AIzaSyB8pY5faEQs6Xug6o_3aR7wkkQNwG7U1-Q",
  authDomain: "test-a-online.firebaseapp.com",
  databaseURL: "https://test-a-online-default-rtdb.firebaseio.com",
  projectId: "test-a-online",
  storageBucket: "test-a-online.firebasestorage.app",
  messagingSenderId: "2468331357",
  appId: "1:2468331357:web:1aac7674f51b4ec23e32b4"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function startExam(){
    db.ref('examStarted').set(true);
  }
  function endExam(){
    db.ref('examStarted').set(false);
  }

  function removeStudent(id){
    db.ref('students/'+id).remove();
  }

  function loadStudents(){
    db.ref('students').on('value', snap=>{
      const students = snap.val() || {};
      const tbody = document.getElementById('studentsTable');
      tbody.innerHTML='';
      Object.keys(students).forEach(id=>{
        const s=students[id];
        const tr=document.createElement('tr');
        tr.innerHTML=`<td>${s.name}</td><td>${s.score||0}</td>
        <td><button onclick="removeStudent('${id}')">Çıxart</button></td>`;
        tbody.appendChild(tr);
      });
    });
  }

  loadStudents();
</script>
</body>
</html>
